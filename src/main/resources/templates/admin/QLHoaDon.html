<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω h√≥a ƒë∆°n</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{
  --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --muted:#9ca3af;
  --brand:#6366f1; --brand-2:#22c55e; --danger:#ef4444; --border:#1f2937;
  --card:#0b1220; --shadow:0 10px 30px rgba(0,0,0,.25);
  --green:#22c55e; --blue:#3b82f6; --orange:#f97316; --red:#ef4444;
}
:root.light{
  --bg:#f3f4f6; --panel:#fff; --text:#0f172a; --muted:#6b7280;
  --brand:#4f46e5; --brand-2:#16a34a; --danger:#dc2626; --border:#e5e7eb;
  --card:#fff; --shadow:0 10px 20px rgba(0,0,0,.06);
  --green:#16a34a; --blue:#2563eb; --orange:#ea580c; --red:#dc2626;
}
*{box-sizing:border-box;}
body{margin:0;background:var(--bg);color:var(--text);
     font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;}
.app{display:grid;grid-template-columns:260px 1fr;min-height:100vh;transition:grid-template-columns 0.3s;}
.app.collapsed{grid-template-columns:76px 1fr;}
.sidebar{background:var(--panel);border-right:1px solid var(--border);
         padding:16px;display:flex;flex-direction:column;gap:12px;transition:all 0.3s;}
.brand{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:12px;
       background:linear-gradient(135deg,var(--brand),#0ea5e9);color:#fff;box-shadow:var(--shadow);}
.brand .logo{width:34px;height:34px;border-radius:10px;background:rgba(255,255,255,.2);
             display:grid;place-items:center;font-weight:700;}
.nav{margin-top:8px;display:flex;flex-direction:column;gap:6px;}
.nav a{display:flex;align-items:center;gap:10px;padding:10px 12px;color:var(--text);
       text-decoration:none;border-radius:10px;border:1px solid transparent;}
.nav a:hover{background:rgba(99,102,241,.12);border-color:rgba(99,102,241,.25);}
.nav a.active{background:rgba(99,102,241,.18);border-color:rgba(99,102,241,.35);}
.app.collapsed .sidebar .brand span,
.app.collapsed .sidebar .nav a span:nth-child(2){display:none;}
.content{display:flex;flex-direction:column;transition:all 0.3s;}
header{position:sticky;top:0;z-index:5;background:var(--panel);
       border-bottom:1px solid var(--border);display:flex;align-items:center;
       gap:12px;padding:10px 16px;}
.icon-btn{border:1px solid var(--border);background:transparent;color:var(--text);
          padding:8px 10px;border-radius:10px;cursor:pointer;}
.search{flex:1;display:flex;align-items:center;gap:10px;background:var(--card);
        border:1px solid var(--border);padding:8px 12px;border-radius:12px;}
.search input{flex:1;background:transparent;border:0;outline:none;color:var(--text);}
.right{display:flex;align-items:center;gap:10px;}
.avatar{width:34px;height:34px;border-radius:50%;
        background:linear-gradient(135deg,#22c55e,#06b6d4);}
main{padding:18px;display:flex;flex-direction:column;gap:18px;}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;
      padding:16px;box-shadow:var(--shadow);}
table{width:100%;border-collapse:collapse;font-size:13px;}
th,td{padding:10px 8px;border-bottom:1px solid var(--border);text-align:left;}
th{color:var(--muted);font-weight:600;}
tr:hover td{background:rgba(148,163,184,.06);}
.kpi-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
               gap:16px;margin-bottom:18px;}
.kpi-card{display:flex;justify-content:space-between;align-items:center;padding:16px;
          border-radius:12px;color:#fff;box-shadow:var(--shadow);}
.kpi-card h3{margin:0;font-size:14px;}
.kpi-card p{margin:4px 0 0;font-size:18px;font-weight:700;}
.bg-gradient-green{background:linear-gradient(135deg,var(--green),#22c55e);}
.bg-gradient-blue{background:linear-gradient(135deg,var(--blue),#3b82f6);}
.bg-gradient-orange{background:linear-gradient(135deg,var(--orange),#f97316);}
.bg-gradient-red{background:linear-gradient(135deg,var(--red),#ef4444);}
.chart-container{height:300px;}
.logout-btn{
  margin-top:auto;display:flex;align-items:center;gap:10px;
  padding:10px 12px;color:var(--danger);text-decoration:none;border-radius:10px;
  border:1px solid transparent;font-size:14px;font-weight:500;transition:all 0.2s;
}
.logout-btn i{width:18px;text-align:center;}
.logout-btn:hover{background:rgba(239,68,68,.12);border-color:rgba(239,68,68,.25);}
.avatar-img {
    width: 40px;       /* ho·∫∑c 50px, tu·ª≥ b·∫°n */
    height: 40px;      /* ƒë·∫£m b·∫£o ·∫£nh vu√¥ng */
    border-radius: 50%; /* l√†m ·∫£nh tr√≤n */
    object-fit: cover; /* c·∫Øt ·∫£nh v·ª´a khung */
}

</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <button class="icon-btn" id="toggleSidebar">‚ò∞</button>
    <div class="brand">
      <div class="logo">üì±</div>
      <span><strong>PhoneShop</strong> Admin</span>
    </div>
    <nav class="nav">
      <a href="/admin/dashboard" ><i class="fas fa-home"></i><span>T·ªïng quan</span></a>
      <a href="/admin/users"><i class="fas fa-users"></i><span>Ng∆∞·ªùi d√πng</span></a>
      <a href="/admin/sanpham"><i class="fas fa-box"></i><span>S·∫£n ph·∫©m</span></a>
      <a href="/admin/hoadon"class="active"><i class="fas fa-file-invoice"></i><span>ƒê∆°n h√†ng</span></a>
      <a href="/admin/loai"><i class="fas fa-tags"></i><span>Lo·∫°i S·∫£n Ph·∫©m</span></a>
      <a href="/admin/khuyenmai"><i class="fas fa-gift"></i><span>Khuy·∫øn m√£i</span></a>
      <a href="#"><i class="fas fa-chart-bar"></i><span>B√°o c√°o</span></a>
    </nav>
    <a href="/logout" class="logout-btn"><i class="fas fa-sign-out-alt"></i><span>ƒêƒÉng xu·∫•t</span></a>
  </aside>

  <!-- Content -->
  <div class="content">
    <header>
      <div class="search">üîé <input placeholder="T√¨m ki·∫øm..." /></div>
      <div class="right">
        <button class="icon-btn" id="themeBtn">üåì</button>
        <button class="icon-btn">üîî</button>
<img th:src="${avatar != null} ? @{${avatar}} : @{/images/default-avatar.png}"
     class="avatar-img" alt="Avatar">
<span th:text="${hoten}">T√™n user</span>

      </div>
    </header>

<body>
    <h2>Qu·∫£n l√Ω H√≥a ƒê∆°n</h2>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Ng√†y t·∫°o</th>
                <th>Tr·∫°ng th√°i</th>
                <th>ƒê·ªãa ch·ªâ</th>
                <th>Giao h√†ng</th>
                <th>Ng∆∞·ªùi d√πng</th>
                <th>H√†nh ƒë·ªông</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="hd : ${hoaDons}">
                <td th:text="${hd.idHoaDon}"></td>
                <td th:text="${hd.ngayTao}"></td>
            <td>
    <form th:action="@{'/admin/hoadon/updateStatus/' + ${hd.idHoaDon}}" method="post">
        <select name="status">
            <option value="Ch·ªù x√°c nh·∫≠n" 
                th:selected="${hd.trangThai == 'ƒê·∫∑t h√†ng th√†nh c√¥ng v√† ƒëang ch·ªù x·ª≠ l√Ω'}">ƒê·∫∑t h√†ng th√†nh c√¥ng v√† ƒëang ch·ªù x·ª≠ l√Ω</option>
            <option value="ƒê√£ x√°c nh·∫≠n" 
                th:selected="${hd.trangThai == 'ƒê√£ x√°c nh·∫≠n'}">ƒê√£ x√°c nh·∫≠n</option>
            <option value="ƒêang giao h√†ng" 
                th:selected="${hd.trangThai == 'ƒêang giao h√†ng'}">ƒêang giao h√†ng</option>
            <option value="ƒê√£ giao th√†nh c√¥ng" 
                th:selected="${hd.trangThai == 'ƒê√£ giao th√†nh c√¥ng'}">ƒê√£ giao th√†nh c√¥ng</option>
            <option value="ƒê√£ h·ªßy" 
                th:selected="${hd.trangThai == 'ƒê√£ h·ªßy'}">ƒê√£ h·ªßy</option>
        </select>
        <button type="submit">C·∫≠p nh·∫≠t</button>
    </form>
</td>

                <td th:text="${hd.diaChi}"></td>
                <td th:text="${hd.giaoHang}"></td>
                <td th:text="${hd.user.idUser}"></td>
                <td>
                    <a th:href="@{'/admin/hoadon/view/' + ${hd.idHoaDon}}">üîç Xem</a> |
                    <a th:href="@{'/admin/hoadon/delete/' + ${hd.idHoaDon}}"
                       onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën xo√° h√≥a ƒë∆°n n√†y?')">‚ùå Xo√°</a>
                </td>
            </tr>
        </tbody>
    </table>
    <script>
const root=document.documentElement;
const THEME_KEY='ps_theme';
function applyTheme(t){t==='light'?root.classList.add('light'):root.classList.remove('light');}
applyTheme(localStorage.getItem(THEME_KEY)||'');
document.getElementById('themeBtn').addEventListener('click', ()=>{
  const nowLight=!root.classList.contains('light');
  applyTheme(nowLight?'light':'');
  localStorage.setItem(THEME_KEY,nowLight?'light':'');
});
document.getElementById('toggleSidebar').addEventListener('click', ()=>{
  document.querySelector('.app').classList.toggle('collapsed');
});
// Chart
const ctx=document.getElementById('revenueChart').getContext('2d');
new Chart(ctx,{
  type:'line',
  data:{
    labels:['Ng√†y 1','Ng√†y 2','Ng√†y 3','Ng√†y 4','Ng√†y 5','Ng√†y 6','Ng√†y 7'],
    datasets:[{
      label:'Doanh thu',
      data:[1,2,1.5,3,4,6,5],
      backgroundColor:'rgba(0,123,255,0.2)',
      borderColor:'#007bff',
      borderWidth:2,
      fill:true,
      tension:0.3,
      pointBackgroundColor:'#007bff'
    }]
  },
  options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
});
</script>
</body>
</html>
