<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
<meta charset="UTF-8">
<title>Qu·∫£n l√Ω khuy·∫øn m√£i</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
:root{
  --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --muted:#9ca3af;
  --brand:#6366f1; --danger:#ef4444; --border:#1f2937;
  --card:#0b1220; --shadow:0 10px 30px rgba(0,0,0,.25);
}
:root.light{
  --bg:#f3f4f6; --panel:#fff; --text:#0f172a; --muted:#6b7280;
  --brand:#4f46e5; --danger:#dc2626; --border:#e5e7eb;
  --card:#fff; --shadow:0 10px 20px rgba(0,0,0,.06);
}
*{box-sizing:border-box;}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;}
.app{display:grid;grid-template-columns:260px 1fr;min-height:100vh;transition:grid-template-columns 0.3s;}
.app.collapsed{grid-template-columns:76px 1fr;}
.sidebar{background:var(--panel);border-right:1px solid var(--border);padding:16px;display:flex;flex-direction:column;gap:12px;transition:all 0.3s;}
.brand{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:12px;background:linear-gradient(135deg,var(--brand),#0ea5e9);color:#fff;box-shadow:var(--shadow);}
.brand .logo{width:34px;height:34px;border-radius:10px;background:rgba(255,255,255,.2);display:grid;place-items:center;font-weight:700;}
.nav{margin-top:8px;display:flex;flex-direction:column;gap:6px;}
.nav a{display:flex;align-items:center;gap:10px;padding:10px 12px;color:var(--text);text-decoration:none;border-radius:10px;border:1px solid transparent;}
.nav a:hover{background:rgba(99,102,241,.12);border-color:rgba(99,102,241,.25);}
.nav a.active{background:rgba(99,102,241,.18);border-color:rgba(99,102,241,.35);}
.note{margin-top:auto;font-size:12px;color:var(--muted);border:1px dashed var(--border);padding:10px;border-radius:10px;background:rgba(148,163,184,.04);}
.app.collapsed .sidebar .brand span,
.app.collapsed .sidebar .nav a span:nth-child(2){display:none;}
.content{display:flex;flex-direction:column;transition:all 0.3s;}
header{position:sticky;top:0;z-index:5;background:var(--panel);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;padding:10px 16px;}
.icon-btn{border:1px solid var(--border);background:transparent;color:var(--text);padding:8px 10px;border-radius:10px;cursor:pointer;}
.search{flex:1;display:flex;align-items:center;gap:10px;background:var(--card);border:1px solid var(--border);padding:8px 12px;border-radius:12px;}
.search input{flex:1;background:transparent;border:0;outline:none;color:var(--text);}
.right{display:flex;align-items:center;gap:10px;}
.avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,#22c55e,#06b6d4);}
main{padding:18px;display:flex;flex-direction:column;gap:18px;}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:var(--shadow);}
table{width:100%;border-collapse:collapse;font-size:13px;}
th,td{padding:10px 8px;border-bottom:1px solid var(--border);text-align:left;}
th{color:var(--muted);font-weight:600;}
tr:hover td{background:rgba(148,163,184,.06);}
input, textarea, select, button{width:100%;padding:8px;margin:5px 0;border-radius:8px;border:1px solid var(--border);background:var(--panel);color:var(--text);}
button{cursor:pointer;background:var(--brand);color:#fff;border:none;font-weight:600;}
button:hover{opacity:0.9;}
form .form-group{margin-bottom:10px;}
.action-btn{color:var(--text);text-decoration:none;}
.action-btn:hover{color:var(--brand);}
.logout-btn {
  margin-top: auto;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  color: var(--danger);
  text-decoration: none;
  border-radius: 10px;
  border: 1px solid transparent;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s;
}

.logout-btn i { width: 18px; text-align: center; }

.logout-btn:hover {
  background: rgba(239,68,68,.12); /* m√†u ƒë·ªè nh·∫°t khi hover */
  border-color: rgba(239,68,68,.25);
}
.avatar-img {
    width: 40px;       /* ho·∫∑c 50px, tu·ª≥ b·∫°n */
    height: 40px;      /* ƒë·∫£m b·∫£o ·∫£nh vu√¥ng */
    border-radius: 50%; /* l√†m ·∫£nh tr√≤n */
    object-fit: cover; /* c·∫Øt ·∫£nh v·ª´a khung */
}
</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
  <button class="icon-btn" id="toggleSidebar">‚ò∞</button>
  <div class="brand">
    <div class="logo">üì±</div>
    <span><strong>PhoneShop</strong> Admin</span>
  </div>

  <nav class="nav">
    <a href="/admin/dashboard" ><i class="fas fa-home"></i><span>T·ªïng quan</span></a>
    <a href="/admin/users"><i class="fas fa-users"></i><span>Ng∆∞·ªùi d√πng</span></a>
    <a href="/admin/sanpham"><i class="fas fa-box"></i><span>S·∫£n ph·∫©m</span></a>
    <a href="/admin/hoadon"><i class="fas fa-file-invoice"></i><span>ƒê∆°n h√†ng</span></a>
    <a href="/admin/loai"><i class="fas fa-tags"></i><span>Lo·∫°i S·∫£n Ph·∫©m</span></a>
    <a href="/admin/khuyenmai"class="active"><i class="fas fa-gift"></i><span>Khuy·∫øn m√£i</span></a>
    <a href="#"><i class="fas fa-chart-bar"></i><span>B√°o c√°o</span></a>
  </nav>

  <!-- N√∫t ƒëƒÉng xu·∫•t -->
  <a href="/logout" class="logout-btn"><i class="fas fa-sign-out-alt"></i><span>ƒêƒÉng xu·∫•t</span></a>
</aside>

  <!-- Content -->
  <div class="content">
    <header>
      <div class="search">üîé <input placeholder="T√¨m ki·∫øm khuy·∫øn m√£i..." /></div>
      <div class="right">
        <button class="icon-btn" id="themeBtn">üåì</button>
        <button class="icon-btn">üîî</button>
        <img th:src="${avatar != null} ? @{${avatar}} : @{/images/default-avatar.png}"
     class="avatar-img" alt="Avatar">
<span th:text="${hoten}">T√™n user</span>

      </div>
    </header>

    <main>
      <!-- Form th√™m/s·ª≠a -->
      <div class="card">
        <h2>Th√™m / S·ª≠a khuy·∫øn m√£i</h2>
        <div th:if="${message}" style="color:lime;font-weight:600;margin-bottom:10px;">
          <p th:text="${message}"></p>
        </div>
        <form th:action="@{/admin/khuyenmai/save}" method="post" th:object="${khuyenMai}">
          <input type="hidden" th:field="*{idKhuyenMai}">
          <div class="form-group">
            <label>T√™n khuy·∫øn m√£i:</label>
            <input type="text" th:field="*{tenKhuyenMai}" required>
          </div>
          <div class="form-group">
            <label>M√¥ t·∫£:</label>
            <textarea th:field="*{moTa}"></textarea>
          </div>
          <div class="form-group">
            <label>Ng√†y b·∫Øt ƒë·∫ßu:</label>
            <input type="date" th:field="*{ngayBatDau}" required>
          </div>
          <div class="form-group">
            <label>Ng√†y k·∫øt th√∫c:</label>
            <input type="date" th:field="*{ngayKetThuc}" required>
          </div>
          <div class="form-group">
            <label>Gi·ªù b·∫Øt ƒë·∫ßu:</label>
            <input type="time" th:field="*{gioBatDau}">
          </div>
          <div class="form-group">
            <label>Gi·ªù k·∫øt th√∫c:</label>
            <input type="time" th:field="*{gioKetThuc}">
          </div>
          <div class="form-group">
            <label>Ph·∫ßn trƒÉm gi·∫£m (%):</label>
            <input type="number" min="0" max="100" th:field="*{phanTram}" required>
          </div>
          <div class="form-group">
            <label>Lo·∫°i √°p d·ª•ng:</label>
            <select th:field="*{loaiApDung}" required>
              <option value="" disabled selected>-- Ch·ªçn lo·∫°i --</option>
              <option value="sanpham">S·∫£n ph·∫©m</option>
              <option value="loai">Lo·∫°i</option>
            </select>
          </div>
          <button type="submit">üíæ L∆∞u</button>
          <a th:href="@{/admin/khuyenmai}"><button type="button">Hu·ª∑</button></a>
        </form>
      </div>

      <!-- Danh s√°ch -->
      <div class="card">
        <h2>Danh s√°ch khuy·∫øn m√£i</h2>
        <table>
          <thead>
          <tr>
            <th>ID</th><th>T√™n</th><th>Th·ªùi gian</th><th>Gi·∫£m</th><th>√Åp d·ª•ng</th><th>H√†nh ƒë·ªông</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="km : ${dsKhuyenMai}">
            <td th:text="${km.idKhuyenMai}">1</td>
            <td th:text="${km.tenKhuyenMai}">Khuy·∫øn m√£i A</td>
            <td>
              <span th:text="${km.ngayBatDau}"></span> - 
              <span th:text="${km.ngayKetThuc}"></span>
            </td>
            <td th:text="${km.phanTram + '%'}">20%</td>
            <td th:text="${km.loaiApDung}">loai</td>
            <td>
              <a class="action-btn" th:href="@{'/admin/khuyenmai/edit/' + ${km.idKhuyenMai}}">‚úèÔ∏è</a> |
              <a class="action-btn" th:href="@{'/admin/khuyenmai/delete/' + ${km.idKhuyenMai}}"
                 onclick="return confirm('Xo√° khuy·∫øn m√£i n√†y?')">üóëÔ∏è</a>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </main>
  </div>
</div>

<script>
const root=document.documentElement;
const THEME_KEY='ps_theme';
function applyTheme(t){t==='light'?root.classList.add('light'):root.classList.remove('light');}
applyTheme(localStorage.getItem(THEME_KEY)||'');
document.getElementById('themeBtn').addEventListener('click', ()=>{
  const nowLight=!root.classList.contains('light');
  applyTheme(nowLight?'light':'');
  localStorage.setItem(THEME_KEY,nowLight?'light':'');
});
document.getElementById('toggleSidebar').addEventListener('click', ()=>{
  document.querySelector('.app').classList.toggle('collapsed');
});
</script>
</body>
</html>
