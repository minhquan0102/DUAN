<!-- file: admin/QLNguoiDungContent.html -->
<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="content">
  <main>
    <section class="grid">
      <!-- Cột trái: Form Thêm/Sửa -->
      <div class="card" style="grid-column: span 4;">
        <h3 class="section-title">Thêm / Sửa người dùng</h3>
        <form th:action="@{/admin/users/save}" th:object="${user}" method="post" class="form-vertical">
          <label>Email (ID):</label>
          <input type="email" th:field="*{idUser}" required>
          <label>Họ tên:</label>
          <input type="text" th:field="*{hoten}" required>
          <label>Mật khẩu:</label>
          <input type="password" th:field="*{matkhau}" required>
          <label>Ngày sinh:</label>
          <input type="date" th:field="*{ngaysinh}">
          <label>Ngày đăng ký:</label>
          <input type="date" th:field="*{ngaydangky}" readonly>
          <label>Địa chỉ:</label>
          <input type="text" th:field="*{diachi}">
          <label>SĐT:</label>
          <input type="text" th:field="*{sdt}">
          <label>Giới tính:</label>
          <select th:field="*{gioitinh}">
            <option value="Nam">Nam</option>
            <option value="Nữ">Nữ</option>
          </select>
          <label>Vai trò:</label>
          <select th:field="*{vaitro}">
            <option value="true">Admin</option>
            <option value="false">Người dùng</option>
          </select>
          <label>Trạng thái:</label>
          <select th:field="*{trangthai}">
            <option value="true">Hoạt động</option>
            <option value="false">Khóa</option>
          </select>
          <label>Ảnh đại diện (link):</label>
          <input type="text" th:field="*{hinh}">
          <button type="submit" class="btn primary">Lưu</button>
        </form>
      </div>

      <!-- Cột phải: Chi tiết + Danh sách -->
      <div style="grid-column: span 8; display:flex; flex-direction:column; gap:18px;">
        <!-- Chi tiết người dùng -->
        <div class="card">
          <h3 class="section-title">Chi tiết người dùng</h3>
          <div th:if="${user != null}" style="display:flex; gap:20px; align-items:flex-start;">
            <div>
              <img th:src="${user.hinh}" alt="Avatar"
                   style="width:120px;height:120px;object-fit:cover;border-radius:50%;
                          border:3px solid var(--border);box-shadow:0 2px 6px rgba(0,0,0,.2)">
            </div>
            <div style="flex:1;">
              <p><b>Email:</b> <span th:text="${user.idUser}"></span></p>
              <p><b>Họ tên:</b> <span th:text="${user.hoten}"></span></p>
              <p><b>Ngày sinh:</b> <span th:text="${user.ngaysinh}"></span></p>
              <p><b>Địa chỉ:</b> <span th:text="${user.diachi}"></span></p>
              <p><b>SĐT:</b> <span th:text="${user.sdt}"></span></p>
              <p><b>Giới tính:</b> <span th:text="${user.gioitinh}"></span></p>
              <p><b>Vai trò:</b> <span th:text="${user.vaitro ? 'Admin' : 'User'}"></span></p>
              <p><b>Trạng thái:</b> <span th:text="${user.trangthai != null and user.trangthai ? 'Hoạt động' : 'Khóa'}"></span></p>
            </div>
          </div>
          <div th:if="${user == null}" class="muted">
            Chưa chọn người dùng để sửa.
          </div>
        </div>

        <!-- Danh sách người dùng -->
        <div class="card">
          <h3 class="section-title">Danh sách người dùng</h3>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Email (ID)</th>
                  <th>Họ tên</th>
                  <th>Vai trò</th>
                  <th>Giới tính</th>
                  <th>Ngày sinh</th>
                  <th>SĐT</th>
                  <th>Trạng thái</th>
                  <th>Hành động</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="u : ${list}">
                  <td th:text="${u.idUser}"></td>
                  <td th:text="${u.hoten}"></td>
                  <td th:text="${u.vaitro ? 'Admin' : 'User'}"></td>
                  <td th:text="${u.gioitinh}"></td>
                  <td th:text="${u.ngaysinh}"></td>
                  <td th:text="${u.sdt}"></td>
                  <td th:text="${u.trangthai ? 'Hoạt động' : 'Khóa'}"></td>
                  <td>
                    <a th:href="@{/admin/users(editId=${u.idUser})}" class="btn">Sửa</a>
                    <a th:href="@{/admin/users/delete/{id}(id=${u.idUser})}" onclick="return confirm('Xác nhận xóa người dùng?')" class="btn danger">Xóa</a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
</body>
</html>
