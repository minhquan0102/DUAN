<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${product.tenSanPham}"></title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Poppins', sans-serif;
        margin: 0;
        padding: 40px;
        background-color: #f8fafc;
        color: #2d3748;
    }

    header {
        text-align: center;
        margin-bottom: 40px;
    }

    header h1 {
        font-size: 2.5rem;
        font-weight: 600;
        color: #1a202c;
        margin: 0;
    }

    .product-detail {
        display: flex;
        gap: 30px;
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .product-image-container {
        flex: 1;
        overflow: hidden;
        border-radius: 10px;
    }

    .product-image {
        max-width: 100%;
        height: auto;
        border-radius: 10px;
        transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .product-image:hover {
        transform: scale(1.05);
    }

    .product-image.fade {
        opacity: 0;
    }

    .product-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .product-info h2 {
        font-size: 1.8rem;
        font-weight: 600;
        color: #1a202c;
        margin: 0;
    }

    .product-info p {
        font-size: 1rem;
        color: #4a5568;
        line-height: 1.6;
    }

    .product-info .price {
        font-size: 1.2rem;
        font-weight: 500;
        color: #e53e3e;
    }

    .product-info .original-price {
        font-size: 1rem;
        color: #718096;
        text-decoration: line-through;
    }

    .color-options {
        display: flex;
        gap: 12px;
        margin-top: 15px;
    }

    .color-button {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        background-color: #edf2f7;
        font-size: 0.9rem;
        font-weight: 500;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .color-button:hover {
        background-color: #e2e8f0;
        transform: translateY(-2px);
    }

    .color-button.active {
        background-color: #3182ce;
        color: white;
        transform: translateY(-2px);
    }

    form {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-top: 20px;
    }

    form label {
        font-size: 1rem;
        font-weight: 500;
        color: #2d3748;
    }

    form input[type="number"] {
        width: 80px;
        padding: 10px;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
    }

    form button {
        padding: 12px 24px;
        background-color: #3182ce;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }

    form button:hover {
        background-color: #2b6cb0;
        transform: translateY(-2px);
    }

    a.back-link {
        display: inline-block;
        margin-top: 30px;
        color: #3182ce;
        font-size: 1rem;
        font-weight: 500;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    a.back-link:hover {
        color: #2b6cb0;
        text-decoration: underline;
    }

    /* Comment Section Styles */
    .comment-section {
        max-width: 1000px;
        margin: 40px auto;
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .comment-section h3 {
        font-size: 1.5rem;
        font-weight: 600;
        color: #1a202c;
        margin-bottom: 20px;
    }

    .comment-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-bottom: 30px;
    }

    .comment-form textarea {
        width: 100%;
        min-height: 100px;
        padding: 12px;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        resize: vertical;
    }

    .comment-form button {
        align-self: flex-start;
        padding: 12px 24px;
        background-color: #3182ce;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .comment-form button:hover {
        background-color: #2b6cb0;
        transform: translateY(-2px);
    }

    .comment-list {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .comment-item {
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 15px;
    }

    .comment-item .comment-author {
        font-size: 1rem;
        font-weight: 500;
        color: #2d3748;
        margin-bottom: 5px;
    }

    .comment-item .comment-date {
        font-size: 0.85rem;
        color: #718096;
        margin-bottom: 10px;
    }

    .comment-item .comment-content {
        font-size: 1rem;
        color: #4a5568;
        line-height: 1.6;
    }
</style>
</head>
<body>
    <header>
        <h1 th:text="${product.tenSanPham}"></h1>
    </header>

    <div class="product-detail">
        <div class="product-image-container">
         <img id="product-image"
     th:src="@{/images/} + (${product.hinh} ?: 'placeholder.jpg')" 
     alt="H√¨nh s·∫£n ph·∫©m" 
     class="product-image"/>

        </div>
        <div class="product-info">
            <h2 th:text="${product.tenSanPham}"></h2>
            <p th:text="${product.mota}"></p>
            <p class="original-price" th:if="${product.giamgia > 0}">
                Gi√° g·ªëc: <span th:text="${#numbers.formatInteger(product.gia, 0, 'COMMA')} + ' VNƒê'"></span>
            </p>
            <p class="price">
                Gi√°: <span th:text="${#numbers.formatInteger(product.gia * (1 - product.giamgia / 100), 0, 'COMMA')} + ' VNƒê'"></span>
                <span th:if="${product.giamgia > 0}" th:text="'(-' + ${product.giamgia} + '%)'"></span>
            </p>

            <h3>Ch·ªçn m√†u:</h3>
            <div class="color-options" id="color-options">
              <button th:each="variant : ${variants}" 
        th:text="${variant.tenMau}" 
        th:data-mau="${variant.tenMau}"
        th:data-image="@{'/images/' + ${variant.hinhAnh}}"
        class="color-button" 
        type="button"></button>

            </div>

            <form th:action="@{/cart/add}" method="post">
                <input type="hidden" name="idSanPham" th:value="${product.idSanPham}"/>
                <input type="hidden" name="mau" id="selected-color" value=""/>
                <label for="soLuong">S·ªë l∆∞·ª£ng:</label>
                <input type="number" name="soLuong" value="1" min="1"/>
                <button type="submit">üõí Th√™m v√†o gi·ªè h√†ng</button>
            </form>

            <a href="/products" class="back-link">‚Üê Quay l·∫°i danh s√°ch</a>
        </div>
    </div>

    <div class="comment-section">
        <h3>B√¨nh lu·∫≠n</h3>
        <form th:action="@{/comments/add}" method="post" class="comment-form">
            <input type="hidden" name="idSanPham" th:value="${product.idSanPham}"/>
            <textarea name="content" placeholder="Vi·∫øt b√¨nh lu·∫≠n c·ªßa b·∫°n..." required></textarea>
            <button type="submit">G·ª≠i b√¨nh lu·∫≠n</button>
        </form>
        <div class="comment-list">
            <div th:each="comment : ${comments}" class="comment-item">
                <div class="comment-author" th:text="${comment.author}"></div>
                <div class="comment-date" th:text="${#dates.format(comment.createdAt, 'dd/MM/yyyy HH:mm')}"></div>
                <div class="comment-content" th:text="${comment.content}"></div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $('.color-button').click(function () {
                $('.color-button').removeClass('active');
                $(this).addClass('active');
                
                const selectedColor = $(this).data('mau');
                const newImage = $(this).data('image');
                
                $('#selected-color').val(selectedColor);
                
                $('#product-image').fadeOut(200, function () {
                    $(this).attr('src', newImage).fadeIn(200);
                });
            });
        });
    </script>
</body>
</html>